layui.define(["jquery"],function(t){var e,o,n,a,i=layui.$,s="layext-text-tool",l="layext-textool-pane",r=!0,p=[],c={hide:null,count:null,copy:null,reset:null,clear:null,hideIndex:-1,countIndex:-1,copyIndex:-1,resetIndex:-1,clearIndex:-1,hideName:"hide",countName:"count",copyName:"copy",resetName:"reset",clearName:"clear",hideClass:"layext-textool-minmax",countClass:"layext-textool-count",maxClass:"layext-textool-max",copyClass:"layext-textool-copy",resetClass:"layext-textool-reset",clearClass:"layext-textool-clear",copyTextId:s+"-copy-text",lengthClass:"layext-textool-length",lengthOverClass:s+"-length-over",laytips:"layext-textool-laytips"},d={options:{eleId:null,maxlength:-1,initEnd:i.noop,showEnd:i.noop,hideEnd:i.noop,tools:["count","copy","reset","clear"],tipType:"title",tipColor:"#01AAED",align:"right",color:"#666666",bgColor:"#FFFFFF",borderColor:"#E6E6E6",className:"",zIndex:19891014},init:function(t){var e=this;e.options=i.extend(e.options,t),o=""===i.trim(e.options.eleId)?"."+s:"#"+e.options.eleId,e.initStyle(e),e.initPrototype(),i(o).each(function(t,o){var n=i(this),a=e.options.maxlength;!isNaN(a)&&a>-1&&n.attr("maxlength",a),e.addTextool(e,n)}),e.initTips(e),"function"==typeof e.options.initEnd&&e.options.initEnd()},initStyle:function(t){t.options.zIndex=isNaN(t.options.zIndex)?0:t.options.zIndex||0,n=['<style type="text/css">',"#",c.copyTextId," { width: 0; height: 0; position: absolute; top: -190000px; }",o," { position: relative; z-index: ",t.options.zIndex+1,"; }",o," + .",l," { position: relative; z-index: ",t.options.zIndex,"; margin-top: -2px; display: block; outline: none; }",o," + .",l," * { color: ",t.options.color||"#666666","; }",o," + .",l," a > i { font-size: 12px!important; }",o," + .",l," a { padding: 0 3px; cursor: pointer; }",o," + .",l," a:active { background-color: #E2E2E2; opacity: 0.8; }",o," + .",l," .",c.lengthClass," * { font-family: Consolas, sans-serif; }",o," + .",l," .",c.lengthClass," { display: inline-block; border-width: 0 1px; }",o," + .",l," .",c.lengthClass," * { font-family: Consolas, sans-serif; }",o," + .",l," .",c.lengthOverClass," { color: #FF5722; }",o," + .",l," .",c.countClass,", ",o," + .",l," .",c.maxClass," { display: inline-block; min-width: 26px; height: 16px; line-height: 18px; }",o," + .",l," > .layui-badge { overflow: hidden; border-color: ",t.options.borderColor||"#E6E6E6","; background-color: ",t.options.bgColor||"#FFFFFF","; }",o," + .",l," .",c.maxClass," { opacity: 0.9; }",o," + .",l,"-r { text-align: right; }",o," + .",l,"-l { text-align: left; }","</style>"].join(""),i("head link:last")[0]&&i("head link:last").after(n)||i("head").append(n)},initPrototype:function(){!Array.prototype.indexOf&&(Array.prototype.indexOf=function(t,e){t=t||[];for(var o=t.length;o--;)if(t[o]==e)return o;return-1})},addTextool:function(t,e){var o=e.next("."+l);o[0]||(e.after(t.getToolsNode(t,e)),o=e.next("."+l),t.setEvent(t,e,o)),t.display(t,e,o)},display:function(t,e,o){o.fadeIn()},copyText:function(t,e){if(!e)return!1;!i("#"+c.copyTextId).length&&i("body").append("<textarea id="+c.copyTextId+' readonly="readonly"></textarea>');var o=i("#"+c.copyTextId),n=e.val();o.val(""===n?" ":n).select(),document.execCommand("copy"),t.showTip(t,e,"已复制！")},setValLength:function(t,e){var o=e.next("."+l).find("."+c.countClass);o.text(e.val().length),e.val().length>e.attr("maxlength")?o.addClass(c.lengthOverClass):o.hasClass(c.lengthOverClass)&&o.removeClass(c.lengthOverClass)},setEvent:function(t,o,n){t.setValLength(t,o);var a=o.val();n.on("click","a",function(s){var l=i(this),r=l.children("i.layui-icon");return l.hasClass(c.hideClass)&&(l.nextAll().toggle("fast"),l.prevAll().toggle("fast"),r.hasClass("layui-icon-more")?(r.removeClass("layui-icon-more").addClass("layui-icon-more-vertical"),l.attr(e,"展开"),"function"==typeof t.options.hideEnd&&t.options.hideEnd(o,n)):(r.removeClass("layui-icon-more-vertical").addClass("layui-icon-more"),l.attr(e,"收起"),"function"==typeof t.options.showEnd&&t.options.showEnd(o,n)),e===c.laytips&&t.showTip(t,l,l.attr(e))),l.hasClass(c.copyClass)&&t.copyText(t,o),l.hasClass(c.resetClass)&&(o.val(a),t.setValLength(t,o)),l.hasClass(c.clearClass)&&(o.val(""),t.setValLength(t,o)),layui.stope(s),!1}),o.on("keyup input",function(e){return t.setValLength(t,o),layui.stope(e),!1})},getToolsNode:function(t,e){if(!e)return!1;if(c.hide=['<a href="javascript:;"',t.getTips(t,"收起"),'class="',c.hideClass,'"><i class="layui-icon layui-icon-more"></i></a>'].join(""),t.options.tools=t.options.tools||[c.countName],c.countIndex=t.options.tools.indexOf(c.countName),c.countIndex>-1){var o=e.attr("maxlength")||-1;c.count=['<span class="',c.lengthClass,'"><b class="',c.countClass,'"',t.getTips(t,"当前字数"),">0</b>",o<0?"":['/<span class="',c.maxClass,'"',t.getTips(t,"最大字数"),">",o,"</span>"].join(""),"</span>"].join("")}c.copyIndex=t.options.tools.indexOf(c.copyName),c.copyIndex>-1&&(c.copy=['<a href="javascript:;" class="',c.copyClass,'"',t.getTips(t,"复制"),'><i class="layui-icon layui-icon-file"></i></a>'].join("")),c.resetIndex=t.options.tools.indexOf(c.resetName),c.resetIndex>-1&&(c.reset=['<a href="javascript:;" class="',c.resetClass,'"',t.getTips(t,"重置"),'><i class="layui-icon layui-icon-refresh-1"></i></a>'].join("")),c.clearIndex=t.options.tools.indexOf(c.clearName),c.clearIndex>-1&&(c.clear=['<a href="javascript:;" class="',c.clearClass,'"',t.getTips(t,"清空"),'><i class="layui-icon layui-icon-close"></i></a>'].join("")),"left"===t.options.align?(r=!1,a=l+"-l"):(r=!0,a=l+"-r"),p=['<span class="',l," ",a," ",i.trim(t.options.className),' layui-anim layui-anim-fadein"><span class="layui-badge layui-badge-rim">'],!r&&p.push(c.hide);for(var n=0;n<t.options.tools.length;n++)p.push(c[t.options.tools[n]]||"");return r&&p.push(c.hide),p.push("</span></span>"),p.join("")},getTips:function(t,o){switch(t.options.tipType){case"title":e="title";break;case"laytips":e=c.laytips;break;default:return""}return[" ",e,"=",o," "].join("")},initTips:function(t){i("["+c.laytips+"]").each(function(o,n){var a=i(n);""!==i.trim(a.attr(e))&&a.hover(function(){t.showTip(t,a,a.attr(e))},t.hideTip)})},showTip:function(t,e,o){t.hideTip(),layui.layer.tips(o,e,{tips:[1,t.options.tipColor||"#01AAED"],time:2e3,anim:5,zIndex:(t.options.zIndex||0)+2})},hideTip:function(){layui.layer.closeAll("tips")}};t("textool",d)});