layui.define(["jquery"],(function(exports){var $=layui.$,baseClassName="layext-text-tool",extClassName="layext-textool-pane",style,alignRight=!0,alignClass,nodes=[],tools={hide:null,count:null,copy:null,reset:null,clear:null,hideIndex:-1,countIndex:-1,copyIndex:-1,resetIndex:-1,clearIndex:-1,hideName:"hide",countName:"count",copyName:"copy",resetName:"reset",clearName:"clear",hideClass:"layext-textool-minmax",countClass:"layext-textool-count",maxClass:"layext-textool-max",copyClass:"layext-textool-copy",resetClass:"layext-textool-reset",clearClass:"layext-textool-clear",copyTextId:baseClassName+"-copy-text",lengthClass:"layext-textool-length",lengthOverClass:baseClassName+"-length-over",laytips:"layext-textool-laytips"},defaultOptions={eleId:null,maxlength:-1,initEnd:$.noop,showEnd:$.noop,hideEnd:$.noop,initShow:!0,inner:!1,align:"right",tools:["count","copy","reset","clear"],tipType:"title",tipColor:"#01AAED",color:"#666666",bgColor:"#FFFFFF",borderColor:"#E6E6E6",className:"",zIndex:19891014},Class=function(custom){var _this=this;this.tipsAttr=null,this.selector=null,this.init(this,custom||{})};Class.prototype.init=function(_this,custom){_this.options=$.extend({},defaultOptions,custom),_this.selector=""===$.trim(_this.options.eleId)?"."+baseClassName:"#"+_this.options.eleId,_this.initStyle(_this),_this.initPrototype(),$(_this.selector).each((function(i,n){var $this=$(this),maxlength=_this.options.maxlength;!isNaN(maxlength)&&maxlength>-1&&$this.attr("maxlength",maxlength),_this.addTextool(_this,$this)})),_this.initTips(_this),"function"==typeof _this.options.initEnd&&_this.options.initEnd()},Class.prototype.initStyle=function(_this){_this.options.zIndex=isNaN(_this.options.zIndex)?0:_this.options.zIndex||0,style=['<style type="text/css">',"#",tools.copyTextId," { width: 0; height: 0; position: absolute; top: -190000px; }",_this.selector," { position: relative; z-index: ",_this.options.zIndex+(_this.options.inner?0:1),"; }",_this.selector," + .",extClassName," { position: relative; z-index: ",_this.options.zIndex,"; margin-top: -2px; display: block; outline: none; }",_this.selector," + .",extClassName," * { color: ",_this.options.color||"#666666","; }",_this.selector," + .",extClassName," a > i { font-size: 12px!important; }",_this.selector," + .",extClassName," a { padding: 0 3px; cursor: pointer; }",_this.selector," + .",extClassName," a:active { background-color: #E2E2E2; opacity: 0.8; }",_this.selector," + .",extClassName," .",tools.lengthClass," * { font-family: Consolas, sans-serif; }",_this.selector," + .",extClassName," .",tools.lengthClass," { display: inline-block; border-width: 0 1px; }",_this.selector," + .",extClassName," .",tools.lengthClass," * { font-family: Consolas, sans-serif; }",_this.selector," + .",extClassName," .",tools.lengthOverClass," { color: #FF5722; }",_this.selector," + .",extClassName," .",tools.countClass,", ",_this.selector," + .",extClassName," .",tools.maxClass," { display: inline-block; min-width: 26px; height: 16px; line-height: 18px; }",_this.selector," + .",extClassName," > .layui-badge { overflow: hidden; border-color: ",_this.options.borderColor||"#E6E6E6","; background-color: ",_this.options.bgColor||"#FFFFFF","; }",_this.selector," + .",extClassName,"-r.",extClassName,"-inner > .layui-badge { border-right: 0 none; border-radius: 15px 0 17px; margin-right: 1px; }",_this.selector," + .",extClassName,"-l.",extClassName,"-inner > .layui-badge { border-left: 0 none; border-radius: 0 15px 0; margin-left: 1px; }",_this.selector," + .",extClassName,"-inner > .layui-badge  { top: -18px; border-bottom: 0 none; opacity: 0.8; }",_this.selector," + .",extClassName,"-inner > .layui-badge:hover  { opacity: 1; }",_this.selector," + .",extClassName," .",tools.maxClass," { opacity: 0.9; }",_this.selector," + .",extClassName,"-r { text-align: right; }",_this.selector," + .",extClassName,"-l { text-align: left; }",_this.selector," + .",extClassName,"-inner { height: 0; }","</style>"].join(""),$("head link:last")[0]&&$("head link:last").after(style)||$("head").append(style)},Class.prototype.initPrototype=function(){!Array.prototype.indexOf&&(Array.prototype.indexOf=function(array,value){for(var i=(array=array||[]).length;i--;)if(array[i]==value)return i;return-1})},Class.prototype.addTextool=function(_this,$target){var $extPane=$target.next("."+extClassName);$extPane[0]||($target.after(_this.getToolsNode(_this,$target)),$extPane=$target.next("."+extClassName),_this.setEvent(_this,$target,$extPane)),$extPane.fadeIn(200,(function(){!_this.options.initShow&&$extPane.find("."+tools.hideClass).trigger("click")}))},Class.prototype.copyText=function(_this,$target){if(!$target)return!1;!$("#"+tools.copyTextId).length&&$("body").append("<textarea id="+tools.copyTextId+' readonly="readonly"></textarea>');var $copy=$("#"+tools.copyTextId),value=$target.val();$copy.val(""===value?" ":value).select(),document.execCommand("copy"),_this.showTip(_this,$target,"已复制！")},Class.prototype.setValLength=function(_this,$target){var $length=$target.next("."+extClassName).find("."+tools.countClass);$length.text($target.val().length),$target.val().length>$target.attr("maxlength")?$length.addClass(tools.lengthOverClass):$length.hasClass(tools.lengthOverClass)&&$length.removeClass(tools.lengthOverClass)},Class.prototype.setEvent=function(_this,$target,$extPane){_this.setValLength(_this,$target);var initValue=$target.val();$extPane.on("click","a",(function(e){var $this=$(this),$icon=$this.children("i.layui-icon");return $this.hasClass(tools.hideClass)&&($this.nextAll().toggle("fast"),$this.prevAll().toggle("fast"),$icon.hasClass("layui-icon-more")?($icon.removeClass("layui-icon-more").addClass("layui-icon-more-vertical"),$this.attr(_this.tipsAttr,"展开"),"function"==typeof _this.options.hideEnd&&_this.options.hideEnd($target,$extPane)):($icon.removeClass("layui-icon-more-vertical").addClass("layui-icon-more"),$this.attr(_this.tipsAttr,"收起"),"function"==typeof _this.options.showEnd&&_this.options.showEnd($target,$extPane)),_this.tipsAttr===tools.laytips&&_this.showTip(_this,$this,$this.attr(_this.tipsAttr))),$this.hasClass(tools.copyClass)&&_this.copyText(_this,$target),$this.hasClass(tools.resetClass)&&($target.val(initValue),_this.setValLength(_this,$target)),$this.hasClass(tools.clearClass)&&($target.val(""),_this.setValLength(_this,$target)),layui.stope(e),!1})),$target.on("keyup input",(function(e){return _this.setValLength(_this,$target),layui.stope(e),!1}))},Class.prototype.getToolsNode=function(_this,$target){if(!$target)return!1;if(tools.hide=['<a href="javascript:;"',_this.getTips(_this,"收起"),'class="',tools.hideClass,'"><i class="layui-icon layui-icon-more"></i></a>'].join(""),_this.options.tools=_this.options.tools||[tools.countName],tools.countIndex=_this.options.tools.indexOf(tools.countName),tools.countIndex>-1){var maxlength=$target.attr("maxlength")||-1;tools.count=['<span class="',tools.lengthClass,'"><b class="',tools.countClass,'"',_this.getTips(_this,"当前字数"),">0</b>",maxlength<0?"":['/<span class="',tools.maxClass,'"',_this.getTips(_this,"最大字数"),">",maxlength,"</span>"].join(""),"</span>"].join("")}tools.copyIndex=_this.options.tools.indexOf(tools.copyName),tools.copyIndex>-1&&(tools.copy=['<a href="javascript:;" class="',tools.copyClass,'"',_this.getTips(_this,"复制"),'><i class="layui-icon layui-icon-file"></i></a>'].join("")),tools.resetIndex=_this.options.tools.indexOf(tools.resetName),tools.resetIndex>-1&&(tools.reset=['<a href="javascript:;" class="',tools.resetClass,'"',_this.getTips(_this,"重置"),'><i class="layui-icon layui-icon-refresh-1"></i></a>'].join("")),tools.clearIndex=_this.options.tools.indexOf(tools.clearName),tools.clearIndex>-1&&(tools.clear=['<a href="javascript:;" class="',tools.clearClass,'"',_this.getTips(_this,"清空"),'><i class="layui-icon layui-icon-close"></i></a>'].join("")),"left"===_this.options.align?(alignRight=!1,alignClass=extClassName+"-l"):(alignRight=!0,alignClass=extClassName+"-r"),nodes=['<span class="layui-unselect ',extClassName," ",alignClass," ",_this.options.inner?extClassName+"-inner ":"",$.trim(_this.options.className),' layui-anim layui-anim-fadein"><span class="layui-badge layui-badge-rim">'],!alignRight&&nodes.push(tools.hide);for(var i=0;i<_this.options.tools.length;i++)nodes.push(tools[_this.options.tools[i]]||"");return alignRight&&nodes.push(tools.hide),nodes.push("</span></span>"),nodes.join("")},Class.prototype.getTips=function(_this,msg){switch(_this.options.tipType){case"title":_this.tipsAttr="title";break;case"laytips":_this.tipsAttr=tools.laytips;break;default:return""}return[" ",_this.tipsAttr,"=",msg," "].join("")},Class.prototype.initTips=function(_this){$("["+tools.laytips+"]").each((function(i,n){var $target=$(n);""!==$.trim($target.attr(_this.tipsAttr))&&$target.hover((function(){_this.showTip(_this,$target,$target.attr(_this.tipsAttr))}),_this.hideTip)}))},Class.prototype.showTip=function(_this,$target,msg){_this.hideTip(),layui.layer.tips(msg,$target,{tips:[1,_this.options.tipColor||"#01AAED"],time:2e3,anim:5,zIndex:(_this.options.zIndex||0)+2})},Class.prototype.hideTip=function(){layui.layer.closeAll("tips")},exports("textool",{init:function(custom){return new Class(custom)}})}));