layui.define(["jquery"],function(exports){var $=layui.$,baseClassName="layui-input-number",keyClassName="layui-keyboard-number",style=['<style type="text/css">',".",baseClassName," + .",keyClassName," { position: absolute; display: block; "," background-color: #f2f2f2; border-radius: 2px; border: 1px solid #e6e6e6; outline: none; }",".",keyClassName," .layui-key-btn { font-family: Consolas; font-size: 17px; font-weight: 600; "," text-align: center; background-color: #ffffff; cursor: pointer; overflow: hidden; padding: 10px; }",".",keyClassName," .layui-key-btn:active { background-color: #f2f2f2; }","</style>"].join(""),numberInput;$("head link:last")[0]&&$("head link:last").after(style)||$("head").append(style),exports("numinput",{options:{topBtns:123,rightBtns:!0,listening:!0,defaultPrec:-1,initEnd:$.noop,showEnd:$.noop,hideEnd:$.noop,zIndex:19999999},init:function(custom){var _this=this;_this.options=$.extend(_this.options,custom),$("."+baseClassName).attr({readonly:"readonly"}).on("focus",function(e){_this.showKeyboard(_this,$(this))}),"function"==typeof _this.options.initEnd&&_this.options.initEnd()},showKeyboard:function(_this,$input){var $keyBoard=$input.next("."+keyClassName);if($keyBoard[0])$keyBoard.show();else{var sizeXS=_this.options.rightBtns?"xs3":"xs4",sizeZero=_this.options.rightBtns?"xs6":"xs4",btn123=['<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="49 97">1</div>',"</div>","</div>",'<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="50 98">2</div>',"</div>","</div>",'<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="51 99">3</div>',"</div>","</div>"].join(""),btn789=['<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="55 103">7</div>',"</div>","</div>",'<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="56 104">8</div>',"</div>","</div>",'<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="57 105">9</div>',"</div>","</div>"].join(""),backspace=['<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="8" lay-tips="退格">','<i class="layui-icon layui-icon-return"></i>',"</div>","</div>","</div>"].join(""),add=['<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="38 39" lay-tips="增加">','<i class="layui-icon layui-icon-up"></i>',"</div>","</div>","</div>"].join(""),reduce=['<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="37 40" lay-tips="减小">','<i class="layui-icon layui-icon-down"></i>',"</div>","</div>","</div>"].join(""),reset=['<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="46" lay-tips="清空">','<i class="layui-icon layui-icon-refresh-1"></i>',"</div>","</div>","</div>"].join("");$input.after(['<div tabindex="0" hidefocus="true" class="',keyClassName,' layui-unselect layui-anim layui-anim-upbit" ','style="width:',$input.width()+10,'px;">','<div class="layui-row layui-col-space1">',789==_this.options.topBtns?btn789:btn123,_this.options.rightBtns?backspace:"",'<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="52 100">4</div>',"</div>","</div>",'<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="53 101">5</div>',"</div>","</div>",'<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="54 102">6</div>',"</div>","</div>",_this.options.rightBtns?add:"",789==_this.options.topBtns?btn123:btn789,_this.options.rightBtns?reduce:"",_this.options.rightBtns?"":backspace,'<div class="layui-col-',sizeZero,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="48 96">0</div>',"</div>","</div>",'<div class="layui-col-',sizeXS,'">','<div class="layui-card">','<div class="layui-key-btn" data-keycode="110 190">.</div>',"</div>","</div>",_this.options.rightBtns?reset:"","</div>","</div>"].join("")),($keyBoard=$input.next("."+keyClassName)).css({top:$input[0].offsetTop+$input[0].offsetHeight+4+"px",left:$input[0].offsetLeft+"px","z-index":_this.options.zIndex}),$keyBoard.on("touchstart click",".layui-key-btn",function(e){return _this.setValue(_this,$input,$(this)),layui.stope(e),!1}),$keyBoard.on("blur",function(e){_this.setValueRange(_this,$input,_this.toFixedPrec(_this,$input)),$keyBoard.remove(),"function"==typeof _this.options.hideEnd&&_this.options.hideEnd($input)}),_this.options.listening&&_this.initKeyListening(_this,$input,$keyBoard)}$keyBoard.on("focus",function(){"function"==typeof _this.options.showEnd&&_this.options.showEnd($input,$keyBoard)}).focus()},initKeyListening:function(_this,$input,$keyBoard){var $key,code;$keyBoard.on("keydown",function(e){code=e.keyCode;var inputNumber=parseInt($input.val())||0;if(107===code||e.shiftKey&&187===code)inputNumber<0&&_this.setValueRange(_this,$input,Math.abs(inputNumber));else if(109===code||e.shiftKey&&189===code)inputNumber>0&&_this.setValueRange(_this,$input,"-"+inputNumber);else if(($key=$keyBoard.find(".layui-key-btn[data-keycode~="+code+"]"))[0]&&($key.trigger("click").css("background-color","#f2f2f2"),$keyBoard.off("keyup").on("keyup",function(e){$(".layui-key-btn[data-keycode]").css("background-color","#ffffff")})),code>36&&code<41)return!1;return!0})},toFixedPrec:function(_this,$input,val1,val2){var m,s,rs,prec=$.trim($input.data("prec"));for(prec=""===prec?_this.options.defaultPrec:prec,rs=(val1=""==(val1=void 0===val1?$input.val():val1)?$input.attr("min")||0:val1).toString().split(".")[1],prec<0&&(prec=rs&&rs.length||prec),rs=(val2=val2||0).toString().split(".")[1],prec=Math.max(prec,rs?rs.length:0),(rs=(s=((val1*(m=Math.pow(10,prec))+val2*m).toFixed(0)/m).toString()).indexOf("."))<0&&prec>0&&(rs=s.length,s+=".");s.length<=rs+prec;)s+="0";return s},setValueRange:function(_this,$input,value){var minVal=$input.attr("min")||Math.pow(-2,63),maxVal=$input.attr("max")||Math.pow(2,63)-1;minVal="string"==typeof minVal&&minVal.indexOf("0")>-1?parseFloat(minVal):parseInt(minVal),maxVal="string"==typeof maxVal&&maxVal.indexOf("0")>-1?parseFloat(maxVal):parseInt(maxVal),value<minVal&&(value=minVal,_this.tips($input,"最小值为 "+minVal+"！")),value>maxVal&&(value=maxVal,_this.tips($input,"最大值为 "+maxVal+"！")),value=value<minVal?minVal:value>maxVal?maxVal:value,$input.val(value)},setValue:function(_this,$input,$key){var inputVal=$.trim($input.val()),keyVal=$.trim($key.text()),prec=$.trim($input.data("prec")),isDecimal=inputVal.indexOf(".")>-1;if(prec="0"===prec?0:_this.options.defaultPrec,$.inArray(keyVal,["0","1","2","3","4","5","6","7","8","9","."])>-1){if("."===keyVal){if(""===inputVal||isDecimal)return;if(0===prec)return void _this.tips($input,"当前字段不允许输入小数！")}if("0"===keyVal&&0===inputVal.indexOf("0")&&!isDecimal)return;if(inputVal.indexOf(".")>-1&&inputVal.split(".")[1].length>=prec&&prec>0)return void _this.tips($input,"精确度为保留小数点后 "+prec+" 位！");inputVal=("."!==keyVal&&"0"===inputVal?"":inputVal)+keyVal,$input.val(inputVal)}else{var changeVal=""===inputVal?0:inputVal,step=$input.attr("step");switch(isDecimal?(step=parseFloat(step)||.1,changeVal=parseFloat(changeVal)):(step=parseInt(step,10)||1,changeVal=parseInt(changeVal,10)),$key.data("keycode")){case"38 39":changeVal=_this.toFixedPrec(_this,$input,changeVal,step);break;case"37 40":changeVal=_this.toFixedPrec(_this,$input,changeVal,-step);break;case 8:var valLength=inputVal.length;return void(valLength&&$input.val(inputVal.substring(0,valLength-1)));case 46:return void $input.val("")}_this.setValueRange(_this,$input,changeVal)}},tips:function($input,msg){return layer.tips(msg,$input,{tips:[1,"#01AAED"],time:2e3,anim:6,zIndex:this.options.zIndex})}})});